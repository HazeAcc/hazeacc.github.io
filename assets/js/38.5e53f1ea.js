(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{241:function(t,a,s){"use strict";s.r(a);var r=s(1),n=Object(r.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"javascript-性能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javascript-性能","aria-hidden":"true"}},[t._v("#")]),t._v(" JavaScript | 性能 ")]),t._v(" "),s("p",[t._v("目前 JavaScript 语言性能越来越好，个人电脑的平均配置也越来越高，但是注重良好的编程规范仍然是优秀编程者的素养。")]),t._v(" "),s("h2",{attrs:{id:"目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#目录","aria-hidden":"true"}},[t._v("#")]),t._v(" 目录 ")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#js-%E4%BB%A3%E7%A0%81"}},[t._v("JS 代码")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#%E5%87%8F%E5%B0%91%E5%BE%AA%E7%8E%AF%E4%B8%AD%E7%9A%84%E6%B4%BB%E5%8A%A8"}},[t._v("减少循环中的活动")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#%E9%81%BF%E5%85%8D%E6%96%B0%E5%BB%BA%E4%B8%8D%E5%BF%85%E8%A6%81%E7%9A%84%E5%8F%98%E9%87%8F"}},[t._v("避免新建不必要的变量")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#dom-%E6%93%8D%E4%BD%9C"}},[t._v("DOM 操作")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#%E5%87%8F%E5%B0%91-dom-%E8%AE%BF%E9%97%AE"}},[t._v("减少 DOM 访问")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#%E5%87%8F%E5%B0%91-dom-%E6%93%8D%E4%BD%9C"}},[t._v("减少 DOM 操作")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#%E5%87%8F%E5%B0%91%E9%A1%B5%E9%9D%A2-reflow"}},[t._v("减少页面 reflow")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#%E7%BC%A9%E5%87%8F-dom-%E8%A7%84%E6%A8%A1"}},[t._v("缩减 DOM 规模")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#%E7%BB%93%E6%9E%84"}},[t._v("结构")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#%E5%BB%B6%E8%BF%9F-javascript-%E5%8A%A0%E8%BD%BD"}},[t._v("延迟 JavaScript 加载")])])])]),t._v(" "),s("li",[s("a",{attrs:{href:"#%E5%BE%85%E8%A1%A5%E5%85%85"}},[t._v("待补充")])])]),t._v(" "),s("br"),t._v(" "),s("hr"),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"js-代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#js-代码","aria-hidden":"true"}},[t._v("#")]),t._v(" JS 代码")]),t._v(" "),s("h3",{attrs:{id:"减少循环中的活动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#减少循环中的活动","aria-hidden":"true"}},[t._v("#")]),t._v(" 减少循环中的活动")]),t._v(" "),s("p",[t._v("若循环中存在某个对象的属性经常被访问而循环不会对其进行修改，可以将其提取出来。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 重构前")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 重构后")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" l "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" arr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" l"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("br"),t._v(" "),s("h3",{attrs:{id:"避免新建不必要的变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#避免新建不必要的变量","aria-hidden":"true"}},[t._v("#")]),t._v(" 避免新建不必要的变量")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 重构前")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" fullName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" firstName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" lastName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fullName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 重构后")]),t._v("\ndocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"demo"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" firstName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" lastName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("注意可读性与性能之间的权衡。")]),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"dom-操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dom-操作","aria-hidden":"true"}},[t._v("#")]),t._v(" DOM 操作")]),t._v(" "),s("h3",{attrs:{id:"减少-dom-访问"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#减少-dom-访问","aria-hidden":"true"}},[t._v("#")]),t._v(" 减少 DOM 访问")]),t._v(" "),s("p",[t._v("访问 HTML DOM 的速度很慢，如果需要多次访问同一个 DOM 元素，可以将其作为本地变量保存下来使用：")]),t._v(" "),s("br"),t._v(" "),s("h3",{attrs:{id:"减少-dom-操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#减少-dom-操作","aria-hidden":"true"}},[t._v("#")]),t._v(" 减少 DOM 操作")]),t._v(" "),s("p",[t._v("构建一个列表。我们可以用两种方式：")]),t._v(" "),s("ul",[s("li",[t._v("在循环体中 createElement 并 append 到父元素中。")]),t._v(" "),s("li",[t._v("在循环体中拼接 HTML 字符串，循环结束后写父元素的 innerHTML。")])]),t._v(" "),s("p",[t._v("第一种方法看起来比较标准，但是每次循环都会对 DOM 进行操作，性能极低。在这里推荐使用第二种方法。")]),t._v(" "),s("br"),t._v(" "),s("h3",{attrs:{id:"减少页面-reflow"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#减少页面-reflow","aria-hidden":"true"}},[t._v("#")]),t._v(" 减少页面 reflow")]),t._v(" "),s("p",[t._v("页面 reflow 是非常耗时的行为，非常容易导致性能瓶颈。下面一些场景会触发浏览器的reflow：")]),t._v(" "),s("ul",[s("li",[t._v("DOM元素的添加、修改（内容）、删除。")]),t._v(" "),s("li",[t._v("应用新的样式或者修改任何影响元素布局的属性。")]),t._v(" "),s("li",[t._v("Resize浏览器窗口、滚动页面。")]),t._v(" "),s("li",[t._v("读取元素的某些属性（offsetLeft/Top/Height/Width、scrollTop/Left/Width/Height、clientTop/Left/Width/Height、getComputedStyle()、currentStyle(in IE))。")])]),t._v(" "),s("br"),t._v(" "),s("h3",{attrs:{id:"缩减-dom-规模"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#缩减-dom-规模","aria-hidden":"true"}},[t._v("#")]),t._v(" 缩减 DOM 规模")]),t._v(" "),s("p",[t._v("编写 HTML 时，尽量保持 HTML DOM 中较少的元素数量，可以提高页面加载速度。")]),t._v(" "),s("p",[t._v("一个较小的 DOM 使每一次搜索 DOM（比如 getElementsByTagName）都更加快速。")]),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#结构","aria-hidden":"true"}},[t._v("#")]),t._v(" 结构")]),t._v(" "),s("h3",{attrs:{id:"延迟-javascript-加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#延迟-javascript-加载","aria-hidden":"true"}},[t._v("#")]),t._v(" 延迟 JavaScript 加载")]),t._v(" "),s("p",[t._v("下载脚本会阻塞其他下载，把脚本放在页面底部可以使浏览器先加载页面。")]),t._v(" "),s("ol",[s("li",[s("p",[t._v('在 script 标签中使用 defer="true"。'),s("br"),t._v("\ndefer 属性规定脚本应在页面完成解析后执行（只适用于外部脚本）。")])]),t._v(" "),s("li",[s("p",[t._v("通过代码向页面添加脚本：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\nwindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onload "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" downScripts"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("downScripts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" element "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"script"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myScript.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])])]),t._v(" "),s("br"),t._v(" "),s("h2",{attrs:{id:"待补充"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#待补充","aria-hidden":"true"}},[t._v("#")]),t._v(" 待补充")])])},[],!1,null,null,null);a.default=n.exports}}]);