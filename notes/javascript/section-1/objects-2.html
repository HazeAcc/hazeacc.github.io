<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Objects 对象基础（2） | 山风笔记集</title>
    <meta name="description" content="记录并分享个人所整理的学习知识的笔记与教程">
    <link rel="icon" href="/imgs/favicon.ico">
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-158846445-2"></script>
  <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'UA-158846445-2');
        </script>
    
    <link rel="preload" href="/assets/css/0.styles.c0e52d69.css" as="style"><link rel="preload" href="/assets/js/app.8447d795.js" as="script"><link rel="preload" href="/assets/js/2.bd61a9fd.js" as="script"><link rel="preload" href="/assets/js/56.48304ea5.js" as="script"><link rel="prefetch" href="/assets/js/10.c23beeee.js"><link rel="prefetch" href="/assets/js/11.a5f8f4b5.js"><link rel="prefetch" href="/assets/js/12.3d44f3b2.js"><link rel="prefetch" href="/assets/js/13.85e66995.js"><link rel="prefetch" href="/assets/js/14.c61deefc.js"><link rel="prefetch" href="/assets/js/15.d567712f.js"><link rel="prefetch" href="/assets/js/16.0bf83400.js"><link rel="prefetch" href="/assets/js/17.39f15163.js"><link rel="prefetch" href="/assets/js/18.e190cbd6.js"><link rel="prefetch" href="/assets/js/19.b00f5399.js"><link rel="prefetch" href="/assets/js/20.24139e2e.js"><link rel="prefetch" href="/assets/js/21.f057fb05.js"><link rel="prefetch" href="/assets/js/22.91c23498.js"><link rel="prefetch" href="/assets/js/23.7e4349d1.js"><link rel="prefetch" href="/assets/js/24.d6b5644e.js"><link rel="prefetch" href="/assets/js/25.652a598d.js"><link rel="prefetch" href="/assets/js/26.239a6015.js"><link rel="prefetch" href="/assets/js/27.264e242d.js"><link rel="prefetch" href="/assets/js/28.b8a526cb.js"><link rel="prefetch" href="/assets/js/29.015f761b.js"><link rel="prefetch" href="/assets/js/3.1fc8e7ad.js"><link rel="prefetch" href="/assets/js/30.0cec9f87.js"><link rel="prefetch" href="/assets/js/31.d44d1dfd.js"><link rel="prefetch" href="/assets/js/32.01db05fd.js"><link rel="prefetch" href="/assets/js/33.b6466c13.js"><link rel="prefetch" href="/assets/js/34.bfcf59c7.js"><link rel="prefetch" href="/assets/js/35.383304c9.js"><link rel="prefetch" href="/assets/js/36.1e6e18c6.js"><link rel="prefetch" href="/assets/js/37.14bf4a83.js"><link rel="prefetch" href="/assets/js/38.5e53f1ea.js"><link rel="prefetch" href="/assets/js/39.5bb4ec98.js"><link rel="prefetch" href="/assets/js/4.7a8bea82.js"><link rel="prefetch" href="/assets/js/40.6c608590.js"><link rel="prefetch" href="/assets/js/41.23bd194f.js"><link rel="prefetch" href="/assets/js/42.d5004363.js"><link rel="prefetch" href="/assets/js/43.0ce9fa33.js"><link rel="prefetch" href="/assets/js/44.3fe716fe.js"><link rel="prefetch" href="/assets/js/45.32c5871d.js"><link rel="prefetch" href="/assets/js/46.b6783264.js"><link rel="prefetch" href="/assets/js/47.f8aab6d2.js"><link rel="prefetch" href="/assets/js/48.1f037f95.js"><link rel="prefetch" href="/assets/js/49.572445ce.js"><link rel="prefetch" href="/assets/js/5.9397a36a.js"><link rel="prefetch" href="/assets/js/50.7180282b.js"><link rel="prefetch" href="/assets/js/51.5e501b8b.js"><link rel="prefetch" href="/assets/js/52.f9837e49.js"><link rel="prefetch" href="/assets/js/53.d3df370a.js"><link rel="prefetch" href="/assets/js/54.6f904856.js"><link rel="prefetch" href="/assets/js/55.fc396f14.js"><link rel="prefetch" href="/assets/js/57.923bb766.js"><link rel="prefetch" href="/assets/js/58.5987358c.js"><link rel="prefetch" href="/assets/js/59.5c2eeb34.js"><link rel="prefetch" href="/assets/js/6.2f1db989.js"><link rel="prefetch" href="/assets/js/60.4ec959b6.js"><link rel="prefetch" href="/assets/js/61.52d60d03.js"><link rel="prefetch" href="/assets/js/62.f341f0fc.js"><link rel="prefetch" href="/assets/js/63.291774ef.js"><link rel="prefetch" href="/assets/js/64.3da1e937.js"><link rel="prefetch" href="/assets/js/65.44f41773.js"><link rel="prefetch" href="/assets/js/66.aea611c0.js"><link rel="prefetch" href="/assets/js/67.9432b5c4.js"><link rel="prefetch" href="/assets/js/68.f8b420bc.js"><link rel="prefetch" href="/assets/js/69.bd196935.js"><link rel="prefetch" href="/assets/js/7.d3342e12.js"><link rel="prefetch" href="/assets/js/70.5f94436d.js"><link rel="prefetch" href="/assets/js/71.f8d75019.js"><link rel="prefetch" href="/assets/js/72.22a2029f.js"><link rel="prefetch" href="/assets/js/73.b5675a90.js"><link rel="prefetch" href="/assets/js/74.b9910b21.js"><link rel="prefetch" href="/assets/js/75.5aa44913.js"><link rel="prefetch" href="/assets/js/76.db5e59d0.js"><link rel="prefetch" href="/assets/js/77.e4edf460.js"><link rel="prefetch" href="/assets/js/78.adaa1ebd.js"><link rel="prefetch" href="/assets/js/79.c98afd34.js"><link rel="prefetch" href="/assets/js/8.f122493c.js"><link rel="prefetch" href="/assets/js/80.dae99de7.js"><link rel="prefetch" href="/assets/js/81.c8c4cc78.js"><link rel="prefetch" href="/assets/js/82.b8f7657a.js"><link rel="prefetch" href="/assets/js/83.708b497a.js"><link rel="prefetch" href="/assets/js/84.e5cf0bec.js"><link rel="prefetch" href="/assets/js/85.677ae3f9.js"><link rel="prefetch" href="/assets/js/86.b7a99301.js"><link rel="prefetch" href="/assets/js/87.4b8fd909.js"><link rel="prefetch" href="/assets/js/9.095bc7b5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c0e52d69.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">山风笔记集</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/" class="nav-link router-link-active">笔记导航</a></li><li class="dropdown-item"><!----> <a href="/notes/javascript/" class="nav-link router-link-active">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/notes/css/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/notes/html/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/notes/network/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/notes/algorithm/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/notes/tools/" class="nav-link">工具</a></li></ul></div></div><div class="nav-item"><a href="/pages/recent.html" class="nav-link">最近</a></div><div class="nav-item"><a href="/pages/msg-board.html" class="nav-link">留言</a></div><div class="nav-item"><a href="/pages/about.html" class="nav-link">关于</a></div><div class="nav-item"><a href="https://www.ceynri.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主页
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.github.com/ceynri" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/" class="nav-link router-link-active">笔记导航</a></li><li class="dropdown-item"><!----> <a href="/notes/javascript/" class="nav-link router-link-active">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/notes/css/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/notes/html/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/notes/network/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/notes/algorithm/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/notes/tools/" class="nav-link">工具</a></li></ul></div></div><div class="nav-item"><a href="/pages/recent.html" class="nav-link">最近</a></div><div class="nav-item"><a href="/pages/msg-board.html" class="nav-link">留言</a></div><div class="nav-item"><a href="/pages/about.html" class="nav-link">关于</a></div><div class="nav-item"><a href="https://www.ceynri.cn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主页
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.github.com/ceynri" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/notes/javascript/" class="sidebar-link">JavaScript 笔记手册</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript 编程语言</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础知识</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/javascript/section-1/basic-introduction.html" class="sidebar-link">JavaScript 入门基础</a></li><li><a href="/notes/javascript/section-1/function.html" class="sidebar-link">函数</a></li><li><a href="/notes/javascript/section-1/data-type.html" class="sidebar-link">数据类型</a></li><li><a href="/notes/javascript/section-1/objects-1.html" class="sidebar-link">Objects 对象基础（1）</a></li><li><a href="/notes/javascript/section-1/objects-2.html" class="active sidebar-link">Objects 对象基础（2）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/javascript/section-1/objects-2.html#目录" class="sidebar-link">目录</a></li><li class="sidebar-sub-header"><a href="/notes/javascript/section-1/objects-2.html#对象方法" class="sidebar-link">对象方法</a></li><li class="sidebar-sub-header"><a href="/notes/javascript/section-1/objects-2.html#“this”" class="sidebar-link">“this”</a></li><li class="sidebar-sub-header"><a href="/notes/javascript/section-1/objects-2.html#构造函数" class="sidebar-link">构造函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/javascript/section-1/objects-2.html#定义规则" class="sidebar-link">定义规则</a></li><li class="sidebar-sub-header"><a href="/notes/javascript/section-1/objects-2.html#构造函数的-return-规则" class="sidebar-link">构造函数的 return 规则</a></li><li class="sidebar-sub-header"><a href="/notes/javascript/section-1/objects-2.html#new-操作符" class="sidebar-link">new 操作符</a></li><li class="sidebar-sub-header"><a href="/notes/javascript/section-1/objects-2.html#其他" class="sidebar-link">其他</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes/javascript/section-1/objects-2.html#回调函数中的-this" class="sidebar-link">回调函数中的 this</a></li></ul></li><li><a href="/notes/javascript/section-1/array.html" class="sidebar-link">Array 类型</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>进阶知识</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/javascript/section-1/type-conversion.html" class="sidebar-link">类型转换专题</a></li><li><a href="/notes/javascript/section-1/higher-order-functions.html" class="sidebar-link">高阶函数专题</a></li><li><a href="/notes/javascript/section-1/exception-handling.html" class="sidebar-link">异常处理语句</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ES6</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/javascript/section-1/es6/arrow-function.html" class="sidebar-link">箭头函数</a></li><li><a href="/notes/javascript/section-1/es6/three-point-operator.html" class="sidebar-link">...运算符</a></li><li><a href="/notes/javascript/section-1/es6/destructuring-assignment.html" class="sidebar-link">解构赋值</a></li><li><a href="/notes/javascript/section-1/es6/promise.html" class="sidebar-link">Promise 对象</a></li><li><a href="/notes/javascript/section-1/es6/async.html" class="sidebar-link">async 函数</a></li><li><a href="/notes/javascript/section-1/es6/class.html" class="sidebar-link">Class 类</a></li><li><a href="/notes/javascript/section-1/es6/map&amp;set.html" class="sidebar-link">Map &amp; Set 类型</a></li><li><a href="/notes/javascript/section-1/es6/symbol.html" class="sidebar-link">Symbol 类型</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>更多的数据类型</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/javascript/section-1/json.html" class="sidebar-link">JSON 类型</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JavaScript 与 浏览器</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/javascript/section-2/introduction.html" class="sidebar-link">JavaScript 与 HTML</a></li><li><a href="/notes/javascript/section-2/html-dom-node.html" class="sidebar-link">HTML DOM 节点</a></li><li><a href="/notes/javascript/section-2/html-dom-event.html" class="sidebar-link">HTML DOM 事件</a></li><li><a href="/notes/javascript/section-2/html-dom-ex.html" class="sidebar-link">HTML DOM 拓展内容</a></li><li><a href="/notes/javascript/section-2/bom.html" class="sidebar-link">BOM</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue 框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/javascript/vue/basic-grammar.html" class="sidebar-link">Vue 基础语法入门</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="javascript-objects-对象基础（2）"><a href="#javascript-objects-对象基础（2）" aria-hidden="true" class="header-anchor">#</a> JavaScript | Objects 对象基础（2）</h1> <p>介绍<code>JavaScript</code>中的<code>Objects</code>对象的语法及相关特性。</p> <blockquote><p>本篇内容对于新手而言可能相对较为难以理解，建议日后在实践中加深关于本篇内容的理解</p></blockquote> <h2 id="目录"><a href="#目录" aria-hidden="true" class="header-anchor">#</a> 目录 </h2> <ul><li><a href="#%E5%AF%B9%E8%B1%A1%E6%96%B9%E6%B3%95">对象方法</a></li> <li><a href="#this">“this”</a></li> <li><a href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0">构造函数</a> <ul><li><a href="#%E5%AE%9A%E4%B9%89%E8%A7%84%E5%88%99">定义规则</a></li> <li><a href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84-return-%E8%A7%84%E5%88%99">构造函数的 return 规则</a></li> <li><a href="#new-%E6%93%8D%E4%BD%9C%E7%AC%A6">new 操作符</a></li> <li><a href="#%E5%85%B6%E4%BB%96">其他</a></li></ul></li> <li><a href="#%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%E4%B8%AD%E7%9A%84-this">回调函数中的 this</a></li></ul> <br> <hr> <br> <h2 id="对象方法"><a href="#对象方法" aria-hidden="true" class="header-anchor">#</a> 对象方法</h2> <p>我们经常称定义于对象中的函数为“方法”，这是出于这个函数在这个对象中所扮演的角色的的称呼，而“函数”则是它的性质。</p> <p>比如对于一个“人”（对象），“走路”是它的一种行为，而定义“如何走路”便是“走路”这个行为所定义的方法：双腿交替迈开（函数内的代码）。</p> <p>创建对象方法的几种方式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. 直接赋值</span>
user<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;Hello!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 先声明后赋值</span>
<span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;Hello!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

user<span class="token punctuation">.</span>sayHi <span class="token operator">=</span> sayHi<span class="token punctuation">;</span>

<span class="token comment">// 3. 对象内赋值</span>
<span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">sayHi</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 4. 方法简写</span>
<span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>一般来说3与4较为正常，而4在绝大部分情况下都与3没有区别。故推荐使用第4种方法。</p> <br> <h2 id="“this”"><a href="#“this”" aria-hidden="true" class="header-anchor">#</a> “this”</h2> <p>在讲构造函数创建对象之前，我们先简单介绍一下<code>this</code>。</p> <p>如果有学过其他编程语言，你可能会察觉到 JavaScript 中的“<code>this</code>”关键字与其他大多数编程语言不太相同。</p> <p>比如，JavaScript 的<code>this</code>可以用于任何函数而不会报语法错误。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这是因为，JavaScript 的<code>this</code>在运行时才求值，其值由调用该函数的“.”<strong>点之前的对象</strong>决定。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">&quot;John&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> admin <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">&quot;Admin&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

user<span class="token punctuation">.</span>f <span class="token operator">=</span> sayHi<span class="token punctuation">;</span>
admin<span class="token punctuation">.</span>f <span class="token operator">=</span> sayHi<span class="token punctuation">;</span>
<span class="token comment">// 函数在两个对象之间共用</span>

user<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// John  (this == user)</span>
admin<span class="token punctuation">.</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Admin  (this == admin)</span>

admin<span class="token punctuation">[</span><span class="token string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Admin（使用方括号亦可）</span>
</code></pre></div><p>但如果在没有任何对象调用该函数，严格模式下的<code>this</code>等于<code>undefined</code>，这时候如果访问属性则会出错；非严格模式下的<code>this</code>将会是全局对象，即<code>window</code>。</p> <p>我们不应该在没有对象的情况下调用<code>this</code>，这一般是错误的。</p> <br> <h2 id="构造函数"><a href="#构造函数" aria-hidden="true" class="header-anchor">#</a> 构造函数</h2> <p>JavaScript 早期时候虽然没有“类”的概念，但我们可以借助<strong>构造函数</strong>来达到我们相似的效果，实现对象结构的复用。</p> <p><em>在现代 JavaScript 中已经有 class 语法了，其本质仍然是一种特殊的函数。</em></p> <h3 id="定义规则"><a href="#定义规则" aria-hidden="true" class="header-anchor">#</a> 定义规则</h3> <p>构造函数在技术上与一般的函数没有区别，但我们约定：</p> <ol><li>大写字母开头</li> <li>只能使用<code>new</code>操作符执行</li></ol> <p>例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// this = {};（隐式创建）</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>isAdmin <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// return this;（隐式返回）</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> Haze <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">&quot;Haze&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 结构等价于</span>
<span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">&quot;Haze&quot;</span><span class="token punctuation">,</span>
    isAdmin<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token function-variable function">sayHi</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="构造函数的-return-规则"><a href="#构造函数的-return-规则" aria-hidden="true" class="header-anchor">#</a> 构造函数的 return 规则</h3> <p>一般来说都让它隐式返回<code>this</code>，如果显式<code>return</code>，则有以下规则：</p> <ul><li>如果返回一个对象，则返回该对象，不返回<code>this</code></li> <li>如果返回其他东西，则忽略，仍然返回<code>this</code></li></ul> <h3 id="new-操作符"><a href="#new-操作符" aria-hidden="true" class="header-anchor">#</a> new 操作符</h3> <p>上面的例子中，隐式创建空对象与隐式返回<code>this</code>都是<code>new</code>的作用。</p> <blockquote><p>使用<code>new</code>操作符调用函数，会自动执行以下步骤：</p> <ol><li>创建一个全新的对象</li> <li>这个对象会被执行<code>[[Prototype]]</code>链接，将原型实例化（不懂可先忽略该行）</li> <li>生成的新对象会绑定到函数调用的<code>this</code>上</li> <li>如果函数没有返回对象类型，那么<code>new</code>表达式中的函数调用会自动返回这个新的对象</li></ol></blockquote> <p>在函数内部，我们可以使用<code>new.target</code>属性来检查该函数被调用时是否使用了<code>new</code>操作符：</p> <ul><li>带 <code>new</code>，返回该函数（即 <code>function Func { ... }</code>）</li> <li>不带 <code>new</code>，则返回 <code>undefined</code></li></ul> <p>这样做使得构造函数的调用变得安全，不会被误调用为普通函数。</p> <h3 id="其他"><a href="#其他" aria-hidden="true" class="header-anchor">#</a> 其他</h3> <ul><li><p>由<code>new.target</code>的特性，我们还可以延伸出一个小 trick。</p> <p>当调用时没有使用<code>new</code>操作符，自动帮忙补上：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">new</span><span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token comment">// 如果没有运行 new</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 自动补上 new</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> john <span class="token operator">=</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> john <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 相同</span>
</code></pre></div><p>但该方法非常不推荐使用，因为不利于阅读。</p></li> <li><p>对于以下对象，我们可以使用其他方法代替使用 <code>new</code> 创建对象：</p> <table><thead><tr><th>符号</th> <th>替代</th></tr></thead> <tbody><tr><td>{}</td> <td>new Object()</td></tr> <tr><td>&quot;&quot;</td> <td>new String()</td></tr> <tr><td>0</td> <td>new Number()</td></tr> <tr><td>false</td> <td>new Boolean()</td></tr> <tr><td>[]</td> <td>new Array()</td></tr> <tr><td>/()/</td> <td>new RegExp()</td></tr> <tr><td>function (){}</td> <td>new Function()</td></tr></tbody></table></li> <li><p>JavaScript 为我们内置了许多常用的对象的构造函数，如日期<code>Date</code>、集合<code>Set</code>以及数组<code>Array</code>。</p></li> <li><p>当构造函数没有参数时，语法上是支持省略括号的：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">;</span>  <span class="token comment">// 等价于 new User();</span>
</code></pre></div><p>但从代码风格角度上并不推荐这么做。</p></li></ul> <br> <h2 id="回调函数中的-this"><a href="#回调函数中的-this" aria-hidden="true" class="header-anchor">#</a> 回调函数中的 this</h2> <p>对于一个对象而言，我们很可能经常需要使用回调函数去改变自身的某个属性。下面看一个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Num</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">delayOutput</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment">// 回调一个匿名函数</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 这里有没有错误？</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Num</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>按照直观上的感觉，我们的<code>setTimeout</code>对一个匿名函数进行了1秒定时的回调，回调函数中会输出<code>this</code>所指向的也就是<code>Num</code>对象的<code>value</code>值，所以一秒之后控制台会输出<code>42</code>。</p> <p>但这是不对的。按照这么执行的结果，我们会得到一个<code>undefined</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code>num<span class="token punctuation">.</span><span class="token function">delayOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
</code></pre></div><p>为什么呢？这是因为，<code>this</code>在匿名函数/箭头函数中有不同的表现：</p> <ul><li>在没有进行绑定的情况下，<strong>匿名函数 <code>function() {...}</code> 的命名空间处于全局对象上</strong>，所以匿名函数的<code>this</code>会等于<code>undefined</code>（严格模式下）或者<code>window</code>（非严格模式下）</li> <li>箭头函数 <code>() =&gt; {}</code> 自身没有<code>this</code>，在<strong>箭头函数内访问<code>this</code>会取得来自外部上下文中的<code>this</code>值</strong></li></ul> <p>从这一点出发，上面的例子中的回调函数中的<code>this</code>实际上指向的是<code>window</code>全局对象，因为<code>window</code>上没有<code>value</code>属性，所以输出<code>undefined</code>。</p> <p>所以在回调函数中需要使用<code>this</code>的情况下，请不要使用匿名函数。</p> <div class="tip custom-block"><p>有人可能要说，欸那我之前定义对象的方法也是用的<code>function() {...}</code>，里面调用<code>this</code>看起来一切正常呀：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">NaN</span><span class="token punctuation">;</span>
<span class="token comment">// 一般对象</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    num<span class="token punctuation">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
    <span class="token function-variable function">getNum</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>num
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">getNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 42</span>
<span class="token comment">// 构造函数创建对象</span>
<span class="token keyword">let</span> <span class="token function-variable function">Constructor</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">65535</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getNum</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// NaN</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 65535</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">getNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 65535</span>
</code></pre></div><p>实际上，这些都已经不是匿名函数了，他们绑定在了一个变量或者属性上，有了一个名字，这个时候<code>this</code>的值就被绑定在了这些对象上面。</p></div> <p>在回调函数这个领域中，箭头函数相对而言就显得非常合适，因为它正好指向了箭头函数所处上下文的对象。</p> <p>在上上一个的例子中，匿名函数的外部上下文就是<code>Num</code>中，实例化后就是<code>num</code>对象。所以上例将匿名函数改为箭头函数，即可正常运行：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Num</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">delayOutput</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 箭头函数</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Num</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
num<span class="token punctuation">.</span><span class="token function">delayOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 一秒后：</span>
<span class="token comment">// 42</span>
</code></pre></div><p>不过，因为箭头函数没有自己的<code>this</code>的问题，我们并不适合使用箭头函数定义需要使用到<code>this</code>的对象方法（这里的对象是指不是使用<code>new</code>操作符创建的对象，而是使用字面量创建的对象），因为这个时候，<code>this</code>不会指向对象本身，而是指向调用者的“上一级”比如<code>window</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
    <span class="token function-variable function">output</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

num<span class="token punctuation">.</span><span class="token function">output</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// undefined</span>
<span class="token comment">// output()中的this没有指向&quot;.&quot;之前的num</span>
</code></pre></div><p>如果是使用<code>new</code>操作符创建的对象，因为前面讲到的：<code>new</code>操作符会将新生成的对象绑定到函数的<code>this</code>上，所以在构造函数中使用箭头函数定义对象方法是没有问题的。</p> <p>总结一下：</p> <ul><li>匿名函数的<code>this</code>为<code>undefined</code>或者<code>window</code></li> <li>箭头函数的<code>this</code>来自箭头函数的外部的上下文</li> <li>如果要使用<code>this</code>，请使用箭头函数</li></ul> <p>另附<code>this</code>的完整规则流程图，以便日后查阅：</p> <p><img src="https://i.loli.net/2020/02/19/mD6cStKphJBVCzy.jpg" alt="this 规则.jpg"></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2020-3-27 2:43:50 ├F10: PM┤</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/notes/javascript/section-1/objects-1.html" class="prev">
          Objects 对象基础（1）
        </a></span> <span class="next"><a href="/notes/javascript/section-1/array.html">
          Array 类型
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8447d795.js" defer></script><script src="/assets/js/2.bd61a9fd.js" defer></script><script src="/assets/js/56.48304ea5.js" defer></script>
  </body>
</html>
